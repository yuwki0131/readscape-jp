# 1.2 在庫管理者向けAPI

## 概要
書籍の在庫管理、注文処理、売上分析を行う管理者向けのAPI機能を提供します。

## 書籍管理API

### エンドポイント
- `POST /api/admin/books` - 新規書籍登録
- `PUT /api/admin/books/{id}` - 書籍情報更新
- `DELETE /api/admin/books/{id}` - 書籍削除
- `GET /api/admin/books` - 管理者向け書籍一覧

### 実装要件
- 書籍情報の完全なCRUD操作
- 画像アップロード機能
- バルク操作対応（CSV インポート/エクスポート）
- 変更履歴の記録

### データ構造
- BookCreateRequest: 新規登録用データ
- BookUpdateRequest: 更新用データ
- BookAdminView: 管理者向け表示データ

## 在庫管理API

### エンドポイント
- `GET /api/admin/inventory` - 在庫一覧取得
- `POST /api/admin/inventory/{bookId}/stock` - 入荷処理
- `GET /api/admin/inventory/low-stock` - 低在庫アラート
- `GET /api/admin/inventory/history` - 在庫変動履歴

### 実装要件
- リアルタイム在庫管理
- 自動発注機能（閾値設定）
- 在庫変動ログ記録
- 在庫予測機能

## 注文管理API

### エンドポイント
- `GET /api/admin/orders` - 注文一覧取得
- `GET /api/admin/orders/{id}` - 注文詳細取得
- `PUT /api/admin/orders/{id}/status` - 注文ステータス更新
- `GET /api/admin/orders/pending` - 処理待ち注文取得

### 実装要件
- 注文ステータス管理（未処理、処理中、発送済み、完了、キャンセル）
- 配送管理機能
- 注文検索・フィルタリング
- 注文履歴管理

## 売上分析API

### エンドポイント
- `GET /api/admin/analytics/sales` - 売上統計取得
- `GET /api/admin/analytics/books/popular` - 人気書籍ランキング
- `GET /api/admin/analytics/reports` - 各種レポート生成
- `GET /api/admin/analytics/dashboard` - ダッシュボード情報

### 実装要件
- 期間別売上集計
- 書籍別売上分析
- 顧客行動分析
- CSV/PDF レポート出力
- グラフ表示用データ提供

## 権限制御

### ロール定義
- ADMIN: 全機能アクセス可能
- MANAGER: 在庫・注文管理のみ
- ANALYST: 分析機能のみ

### セキュリティ要件
- 管理者専用JWT トークン
- IPアドレス制限機能
- 操作ログ記録
- セッションタイムアウト設定

## 技術仕様
- フレームワーク: Spring Boot 3.x + Spring Security
- 認可: メソッドレベル権限制御
- ログ記録: Spring AOP + Logback
- レポート生成: Apache POI（Excel）、iText（PDF）
- 非同期処理: Spring Async